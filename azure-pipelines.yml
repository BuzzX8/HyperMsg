name: HyperMsg.Core
jobs:
- job: build_and_test
  displayName: 'Build and Test'
  steps:
    - task: DotNetCoreCLI@2
      name: build
      displayName: Build
      inputs:
        command: build
        projects: src/**/*.csproj
    - task: DotNetCoreCLI@2
      name: test
      displayName: Test
      inputs:
        command: test
        projects: test/**/*.csproj
- job:
  displayName: 'Publish package'
  dependsOn: build_and_test
  steps:
    - task: DotNetCoreCLI@2
      name: pack
      displayName: 'Create NuGet package'
      inputs:
        command: 'pack'
        searchPatternPack: 'src/**/*.csproj'
        nobuild: true
        versioningScheme: 'byBuildNumber'